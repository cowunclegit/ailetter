# Implementation Plan: Newsletter Draft and Secure Sending

**Branch**: `006-newsletter-draft-send` | **Date**: 2026-01-13 | **Spec**: [specs/006-newsletter-draft-send/spec.md](spec.md)
**Input**: Feature specification from `/specs/006-newsletter-draft-send/spec.md`

## Summary
Implement a dedicated newsletter draft organization screen featuring drag-and-drop reordering for selected items. Secure the distribution process by requiring a two-step validation: sending a preview test mail to a fixed administrator address containing a cryptographically secure confirmation link (UUID), which triggers the final idempotent distribution to all subscribers.

## Technical Context

**Language/Version**: Node.js (Backend), React.js (Frontend)
**Primary Dependencies**: `@dnd-kit/core` (Drag & Drop), `uuid` (Security), Express, Axios, MUI, SendGrid
**Storage**: SQLite3
**Testing**: Jest (Unit & Integration)
**Target Platform**: Web Browser
**Project Type**: Web application
**Performance Goals**: Reordering 10 items < 30s; Test mail delivery < 60s; Final distribution trigger < 10s
**Constraints**: UUID-based confirmation links; Monday-start ISO weeks (for context); Idempotent send API.

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

- [x] **I. Tech Stack**: Uses React.js and Node.js.
- [x] **II. Test-Driven Development (TDD)**: Mandatory. Tests for reordering persistence and secure distribution will be written first.

## Project Structure

### Documentation (this feature)

```text
specs/006-newsletter-draft-send/
├── plan.md              # This file
├── research.md          # Phase 0 output
├── data-model.md        # Phase 1 output
├── quickstart.md        # Phase 1 output
├── contracts/           # Phase 1 output
└── tasks.md             # Phase 2 output (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
backend/
├── src/
│   ├── api/
│   │   └── newsletters.js    # Add endpoints for reordering, test mail, and confirm send
│   ├── models/
│   │   └── newsletterModel.js # Add display_order and confirmation_uuid
│   └── services/
│       └── emailService.js    # Logic for test vs full distribution
└── tests/
    ├── api/
    └── unit/

frontend/
├── src/
│   ├── components/
│   │   └── features/
│   │       └── DraggableItem.jsx # Drag and drop component
│   └── pages/
│       └── NewsletterDraft.jsx  # New draft organization page
└── tests/
```

**Structure Decision**: Web application structure (Option 2) is maintained.